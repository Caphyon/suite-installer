<?xml version="1.0" encoding="utf-8" ?>
<Window
  x:Class="SuiteInstaller.MainWindow"
  xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
  xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
  xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
  xmlns:local="using:SuiteInstaller"
  xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
  mc:Ignorable="d">

  <!--<Window.SystemBackdrop>
    <MicaBackdrop />
  </Window.SystemBackdrop>-->

  <Grid Name="rootGrid">
    <Grid.RowDefinitions>
      <RowDefinition Height="*" />
    </Grid.RowDefinitions>

    <Grid>

      <Grid
        x:Name="AppTitleBar"
        Grid.Row="0"
        Height="48"
        VerticalAlignment="Top"
        Background="{ThemeResource SettingsPageBackground}"
        Canvas.ZIndex="1">
        <Grid.ColumnDefinitions>
          <ColumnDefinition x:Name="LeftPaddingColumn" Width="0" />
          <ColumnDefinition x:Name="IconColumn" Width="Auto" />
          <ColumnDefinition x:Name="TitleColumn" Width="Auto" />
          <ColumnDefinition x:Name="LeftDragColumn" Width="*" />
          <ColumnDefinition
            x:Name="SearchColumn"
            Width="4*"
            MinWidth="220" />
          <ColumnDefinition
            x:Name="RightDragColumn"
            Width="*"
            MinWidth="48" />
          <ColumnDefinition x:Name="ThemeColumn" Width="Auto" />
          <ColumnDefinition x:Name="RightPaddingColumn" Width="0" />
        </Grid.ColumnDefinitions>
        <Image
          x:Name="TitleBarIcon"
          Grid.Column="1"
          Width="25"
          Height="25"
          Margin="13,5,15,0"
          Source="{Binding AppIcon}" />
        <TextBlock
          x:Name="TitleBarTextBlock"
          Grid.Column="2"
          Margin="0,5,0,0"
          VerticalAlignment="Center"
          Style="{StaticResource CaptionTextBlockStyle}"
          Text="{Binding AppName}" />
        <AutoSuggestBox
          x:Name="SearchBox"
          Grid.Column="4"
          MaxWidth="500"
          VerticalAlignment="Center"
          CornerRadius="5"
          PlaceholderText="Search"
          QueryIcon="Find"
          QuerySubmitted="OnControlsSearchBoxQuerySubmitted"
          TextChanged="OnSearchBoxTextChanged">
          <AutoSuggestBox.ItemTemplate>
            <DataTemplate>
              <StackPanel Orientation="Horizontal">
                <Image
                  Width="30"
                  VerticalAlignment="Center"
                  Source="{Binding Icon}" />
                <TextBlock
                  Margin="10,0,0,0"
                  HorizontalAlignment="Center"
                  VerticalAlignment="Center"
                  Text="{Binding Title}" />
              </StackPanel>
            </DataTemplate>
          </AutoSuggestBox.ItemTemplate>
        </AutoSuggestBox>


        <ToggleButton
          x:Name="ThemeButton"
          Grid.Column="5"
          Height="31"
          Margin="0,0,1,0"
          HorizontalAlignment="Right"
          VerticalAlignment="Top"
          AnimatedIcon.State="Normal"
          Background="Transparent"
          BorderThickness="0"
          Click="ThemeButton_Click"
          CornerRadius="0">
          <AnimatedIcon x:Name="Moon">
            <AnimatedIcon.RenderTransform>
              <CompositeTransform ScaleX="3" ScaleY="3" />
            </AnimatedIcon.RenderTransform>
            <AnimatedIcon.Source>
              <local:Moon />
            </AnimatedIcon.Source>
            <AnimatedIcon.FallbackIconSource>
              <SymbolIconSource Symbol="Home" />
            </AnimatedIcon.FallbackIconSource>
          </AnimatedIcon>
          <ToggleButton.Resources>
            <SolidColorBrush x:Key="ToggleButtonBackgroundChecked" Color="Transparent" />
            <SolidColorBrush x:Key="ToggleButtonBackgroundCheckedPointerOver" Color="Transparent" />
            <SolidColorBrush x:Key="ToggleButtonBackgroundCheckedPressed" Color="Transparent" />
          </ToggleButton.Resources>

        </ToggleButton>

      </Grid>
      <NavigationView
        x:Name="navigationView"
        Grid.Row="1"
        AlwaysShowHeader="False"
        BackRequested="OnBackRequested"
        Background="{ThemeResource SettingsPageBackground}"
        Canvas.ZIndex="0"
        CompactModeThresholdWidth="200"
        CompactPaneLength="70"
        DisplayModeChanged="OnNavigationViewDisplayModeChanged"
        ExpandedModeThresholdWidth="200"
        IsBackButtonVisible="Auto"
        IsBackEnabled="True"
        IsPaneOpen="False"
        IsPaneToggleButtonVisible="False"
        IsSettingsVisible="False"
        Loaded="OnNavigationViewLoaded"
        PaneDisplayMode="LeftCompact">

        <NavigationView.MenuItems>
          <NavigationViewItem
            x:Name="home"
            Margin="0,0,0,5"
            Tag="SuiteInstaller.HomePage"
            Tapped="HomeClick">
            <StackPanel
              Height="50"
              AnimatedIcon.State="Selected"
              Orientation="Vertical">
              <AnimatedIcon
                x:Name="homeIcon"
                Height="35"
                Margin="-5,0,0,0"
                Foreground="{ThemeResource IconColor}">
                <local:HomeIcon AccentColor="PaleVioletRed" />
              </AnimatedIcon>
              <TextBlock
                x:Name="homeText"
                Margin="-5,0,0,5"
                HorizontalAlignment="Center"
                VerticalAlignment="Bottom"
                FontSize="10"
                Text="Home" />
            </StackPanel>
          </NavigationViewItem>
        </NavigationView.MenuItems>

        <NavigationView.FooterMenuItems>
          <NavigationViewItem
            x:Name="news"
            SelectsOnInvoked="False"
            Tapped="NewsTapped">
            <StackPanel Orientation="Vertical">
              <FontIcon
                Height="35"
                Margin="-5,0,0,0"
                Glyph="&#xEC24;" />
              <TextBlock
                Margin="-5,0,0,5"
                HorizontalAlignment="Center"
                VerticalAlignment="Bottom"
                FontSize="10"
                Text="What's new" />
            </StackPanel>
          </NavigationViewItem>
          <NavigationViewItem
            x:Name="library"
            Margin="0,0,0,5"
            Tag="SuiteInstaller.LibraryPage"
            Tapped="LibraryClick">
            <StackPanel
              Height="50"
              AnimatedIcon.State="Normal"
              Orientation="Vertical">
              <StackPanel
                x:Name="libraryIcon"
                Margin="-5,0,0,0"
                AnimatedIcon.State="Normal"
                RenderTransformOrigin="0.5,0">
                <AnimatedIcon Height="35" Foreground="{ThemeResource IconColor}">
                  <local:LibraryIcon AccentColor="DarkCyan" />
                </AnimatedIcon>
              </StackPanel>
              <TextBlock
                x:Name="libraryText"
                Margin="-5,0,0,5"
                HorizontalAlignment="Center"
                VerticalAlignment="Bottom"
                FontSize="10"
                Text="Library" />
            </StackPanel>
          </NavigationViewItem>
          <NavigationViewItem SelectsOnInvoked="False">
            <StackPanel Orientation="Vertical">
              <SymbolIcon
                Height="35"
                Margin="-5,0,0,0"
                Symbol="Help" />
              <TextBlock
                Margin="-5,0,0,5"
                HorizontalAlignment="Center"
                VerticalAlignment="Bottom"
                FontSize="10"
                Text="Help" />
            </StackPanel>
            <NavigationViewItem.MenuItems>
              <NavigationViewItem
                x:Name="help"
                Content="Get Help"
                Icon="Help"
                SelectsOnInvoked="False"
                Tapped="GetHelp_Tapped" />
              <NavigationViewItem
                x:Name="feedback"
                Content="Send Feedback"
                Icon="Contact"
                SelectsOnInvoked="False"
                Tapped="Feedback_Tapped" />
            </NavigationViewItem.MenuItems>
          </NavigationViewItem>
        </NavigationView.FooterMenuItems>

        <Grid Margin="0,48,0,0" Background="{ThemeResource SettingsPageBackground}">
          <Grid.ColumnDefinitions>
            <ColumnDefinition Width="*" />
            <ColumnDefinition Width="Auto" />
          </Grid.ColumnDefinitions>
          <Frame x:Name="MainFrame" CornerRadius="0" />
          <local:InstallPane
            Name="InstallPane"
            Grid.Column="1"
            DataContext="{x:Bind GetInstallingPrereqModel, Mode=OneWay}" />
        </Grid>
      </NavigationView>

      <Grid
        x:Name="LoadingOverlay"
        Grid.Row="1"
        HorizontalAlignment="Stretch"
        VerticalAlignment="Stretch"
        Background="{ThemeResource SettingsPageBackground}"
        Visibility="{Binding InstallStateLoaded, Mode=TwoWay, Converter={StaticResource BoolInvToVisibilityConv}}">

        <Grid.RowDefinitions>
          <RowDefinition Height="*" />
          <RowDefinition Height="Auto" />
          <RowDefinition Height="*" />
        </Grid.RowDefinitions>

        <ProgressRing
          Grid.Row="1"
          Width="60"
          Height="60"
          HorizontalAlignment="Center"
          VerticalAlignment="Center"
          IsIndeterminate="True" />

        <TextBlock
          Grid.Row="2"
          Margin="0,20,0,0"
          HorizontalAlignment="Center"
          VerticalAlignment="Top"
          FontSize="16"
          Foreground="{ThemeResource SystemBaseHighColor}"
          Text="Searching for installed applications..." />
      </Grid>
    </Grid>

    <Grid
      x:Name="SmokeGrid"
      HorizontalAlignment="Stretch"
      VerticalAlignment="Stretch"
      Visibility="Collapsed">
      <Grid.Background>
        <SolidColorBrush Opacity="0.8" Color="{ThemeResource SystemChromeAltHighColor}" />
      </Grid.Background>
      <Grid
        x:Name="destinationElement"
        Width="520"
        HorizontalAlignment="Center"
        VerticalAlignment="Center">
        <Grid.ColumnDefinitions>
          <ColumnDefinition Width="*" />
          <ColumnDefinition Width="Auto" />
        </Grid.ColumnDefinitions>

        <StackPanel
          Grid.Column="0"
          BorderBrush="{ThemeResource SettingsPageBackground}"
          BorderThickness="2"
          CornerRadius="10">
          <Grid
            Height="auto"
            HorizontalAlignment="Stretch"
            VerticalAlignment="Stretch"
            Background="{ThemeResource SettingsPageBackground}">
            <StackPanel Margin="12">
              <TextBlock
                Margin="0,0,0,5"
                VerticalAlignment="Center"
                Style="{ThemeResource SubtitleTextBlockStyle}"><Run Text="What's new in&#160;" /><Run Text="{x:Bind Context.AppName, Mode=OneTime}" /></TextBlock>
              <Button
                Content="Upgrade"
                Visibility="{Binding NewUpdate, Converter={StaticResource BoolToVisibilityConv}}"
                HorizontalAlignment="Right"
                Click="UpgradeButton_Click" />
            </StackPanel>
          </Grid>

          <ScrollViewer MaxHeight="400" VerticalScrollBarVisibility="Auto">
            <ItemsControl
              x:Name="UpdatesListView5"
              Padding="-1"
              Background="{ThemeResource SettingsPageBackground}"
              BorderBrush="blue"
              BorderThickness="0"
              CornerRadius="0"
              ItemsSource="{Binding AllUpdates, Mode=OneWay}">
              <ItemsControl.ItemTemplate>
                <DataTemplate x:DataType="local:Update">
                  <StackPanel
                    Height="90"
                    Padding="12"
                    Background="{ThemeResource CardBackgroundFillColorDefaultBrush}"
                    BorderBrush="{ThemeResource SettingsPageBackground}"
                    BorderThickness="2"
                    Orientation="Horizontal">
                    <TextBlock
                      x:Name="UpdateTitle"
                      Text="{x:Bind Title}"
                      TextLineBounds="TrimToCapHeight"
                      TextWrapping="Wrap" />
                    <TextBlock Text="{x:Bind Description}" TextTrimming="CharacterEllipsis" />
                  </StackPanel>
                </DataTemplate>
              </ItemsControl.ItemTemplate>
            </ItemsControl>
          </ScrollViewer>
        </StackPanel>

        <Button
          Grid.Column="1"
          Width="40"
          Height="40"
          Margin="5"
          HorizontalAlignment="Right"
          VerticalAlignment="Top"
          HorizontalContentAlignment="Center"
          VerticalContentAlignment="Center"
          AutomationProperties.Name="Close"
          Click="CloseButtonNews_Click"
          ToolTipService.ToolTip="Close">
          <FontIcon Margin="-1" Glyph="&#xE711;" />
        </Button>
      </Grid>
    </Grid>


  </Grid>
</Window>
